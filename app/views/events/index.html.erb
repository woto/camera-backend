<% content_for :title, "Events" %>

<div class="container">
  <div class="page-actions">
    <h1>Events</h1>
    <%= button_to "Trigger Capture", recorder_trigger_path, class: "primary-button", method: :post %>
  </div>

  <% if @events.any? %>
    <ul class="events-list">
      <% @events.each do |event| %>
        <li class="event-card">
          <%= link_to event_path(event) do %>
            <div class="event-thumbnails">
              <% event.captures.each do |capture| %>
                <% capture.thumbnails.each do |thumb| %>
                  <%= image_tag url_for(thumb), class: "event-thumbnail-mini", alt: "Thumbnail for capture #{capture.id}" %>
                <% end %>
              <% end %>
            </div>
            <div class="event-row">
              <span class="event-date"><%= event.captured_at&.strftime("%Y-%m-%d %H:%M:%S %Z") %></span>
              <span class="event-meta"><%= pluralize(event.captures.size, "capture") %></span>
            </div>
          <% end %>
        </li>
      <% end %>
    </ul>

    <div class="pagination">
      <%= paginate @events %>
    </div>
  <% else %>
    <p>No events yet.</p>
  <% end %>
</div>
