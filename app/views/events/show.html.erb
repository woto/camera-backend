<% content_for :title, "Event ##{@event.id}" %>

<div class="container">
  <div class="page-actions">
    <div class="navigation-links">
      <%= link_to events_path, class: "back-button" do %>
        All events
      <% end %>

      <div class="prev-next-links">
        <% if @next_event %>
          <%= link_to "« Newer", event_path(@next_event), class: "nav-link" %>
        <% end %>
        <% if @prev_event %>
          <%= link_to "Older »", event_path(@prev_event), class: "nav-link" %>
        <% end %>
      </div>
    </div>
    <% if current_user %>
      <%= button_to "Delete event", event_path(@event), method: :delete, data: { turbo_confirm: "Delete this event and all its captures?" }, class: "danger-button" %>
    <% end %>
  </div>

  <h1>Event <%= @event.captured_at.strftime("%Y-%m-%d %H:%M:%S %Z") %></h1>

  <% if @captures.any? %>
    <% @captures.each do |capture| %>
      <div class="capture-card">
        <div class="capture-header">
          <span>Capture #<%= capture.id %></span>
          <span class="capture-time"><%= capture.created_at&.strftime("%Y-%m-%d %H:%M:%S %Z") %></span>
        </div>

        <% if capture.video.attached? %>
          <div class="capture-video">
            <%= video_tag url_for(capture.video), controls: true, preload: "metadata", class: "video-player" %>
          </div>
        <% else %>
          <p>Video not found.</p>
        <% end %>

        <% if capture.thumbnails.attached? %>
          <div class="thumbnails">
            <% capture.thumbnails.each do |thumb| %>
              <%= image_tag url_for(thumb), alt: "Thumbnail for capture #{capture.id}", class: "thumbnail" %>
            <% end %>
          </div>
        <% else %>
          <p>Thumbnails not uploaded.</p>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <p>No captures for this event.</p>
  <% end %>
</div>
